

@model IEnumerable<MedicineInventoryModel>


<div class="card-box mb-30">
	<div class="pd-20">
		<h4 class="text-blue h4">Data Table with Export Buttons</h4>
	</div>
	<a class="btn btn-success mb-3 text-light" asp-controller="MedicineIventory" asp-action="Create">
		<i class="icon-copy fa fa-plus-square-o" aria-hidden="true"></i>
		<span class="mx-1">Add Medicine Inventory</span>
	</a>
	<div class="pb-20">
		<table class="table hover multiple-select-row data-table-export nowrap">
			<thead>
				<tr>
					<th class="table-plus datatable-nosort">ID</th>
					<th>MedicineId</th>
					<th>ExpiryDate</th>
					<th>Quantity</th>
					<th>Unit</th>
					<th></th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				@foreach(var item in Model)
				{
					<tr>
						<td class="table-plus">@item.Id</td>
						<td>@item.MedicineId</td>
						<td>@item.ExpiryDate</td>
						<td>@item.InventoryQuantity</td>
						<td>@item.Unit</td>
						<td>
							<button data-id="@item.Id" type="button" class="btn btn-danger text-light delete-confirm-btn">
								<i class="icon-copy fa fa-trash-o" aria-hidden="true"></i>
							</button>
						</td>
						<td>
							<a asp-action="Edit" asp-controller="Medicine" asp-route-id=@item.Id class="btn btn-danger text-light delete-confirm-btn">
								<i class="icon-copy fa fa-edit" aria-hidden="true"></i>
							</a>
						</td>
					</tr>
				}
			</tbody>
		</table>
	</div>
</div>

<div class="modal fade" id="confirmation-modal" tabindex="-1" role="dialog" style="display: none" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
			<div class="modal-body text-center font-18">
				<h4 class="padding-top-30 mb-30 weight-500">Are you sure you want to delete this medicine inventory?</h4>
				<div class="padding-bottom-30 row" style="max-width: 170px; margin: 0 auto;">
					<div class="col-6">
						<button type="button" class="btn btn-secondary border-radius-100 btn-block confirmation-btn" data-dismiss="modal"><i class="fa fa-times"></i></button>
						NO
					</div>
					<div class="col-6">
						<button type="button" class="btn btn-primary border-radius-100 btn-block confirmation-btn yes-btn" data-dismiss="modal"><i class="fa fa-check"></i></button>
						YES
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<!-- js -->
<script src="~/vendors/scripts/core.js"></script>
<script src="~/vendors/scripts/script.min.js"></script>
<script src="~/vendors/scripts/process.js"></script>
<script src="~/vendors/scripts/layout-settings.js"></script>
<script src="~/src/plugins/datatables/js/jquery.dataTables.min.js"></script>
<script src="~/src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
<script src="~/src/plugins/datatables/js/dataTables.responsive.min.js"></script>
<script src="~/src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
<!-- buttons for Export datatable -->
<script src="~/src/plugins/datatables/js/dataTables.buttons.min.js"></script>
<script src="~/src/plugins/datatables/js/buttons.bootstrap4.min.js"></script>
<script src="~/src/plugins/datatables/js/buttons.print.min.js"></script>
<script src="~/src/plugins/datatables/js/buttons.html5.min.js"></script>
<script src="~/src/plugins/datatables/js/buttons.flash.min.js"></script>
<script src="~/src/plugins/datatables/js/pdfmake.min.js"></script>
<script src="~/src/plugins/datatables/js/vfs_fonts.js"></script>
<!-- Datatable Setting js -->
<script src="~/vendors/scripts/datatable-setting.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag() { dataLayer.push(arguments); }
	gtag('js', new Date());

	gtag('config', 'UA-119386393-1');


	$(document).ready(function () {
		$('.delete-confirm-btn').on('click', function () {
			let id = $(this).attr('data-id');
			showModal(id);
			$('#confirmation-modal .yes-btn').off('click').on('click', function () {
				hideModal();
				$.ajax({
					url: '@Url.Action("Delete", "MedicineInventory")',
					type: 'POST',
					contentType: 'application/x-www-form-urlencoded',
					data: { id: id },
					success: function (data) {
						$(`#row-${id}`).remove();
						toastr.success(data, 'Notification', { timeOut: 2000 });
					},
					error: function (error) {
						console.log(error)
						toastr.error(error.responseText, 'Notification', { timeOut: 2000 });
					}
				});

			});
		});

		function showModal(id) {
			let modal = $('#confirmation-modal');
			modal.attr('data-id', id);
			modal.modal('show');
		}
		function hideModal() {
			let modal = $('#confirmation-modal');
			modal.attr('data-id', '');
			modal.modal('hide');
		}
</script>